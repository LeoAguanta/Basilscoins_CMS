angular.module("app",["ngAnimate","ngSanitize","ngCookies","ui.bootstrap","ui.router","textAngular","ui-notification","rbGrid","ui.bootstrap.contextMenu"]);angular.module("app").config(["$stateProvider",function(n){var t=localStorage.getItem("HtmlTemplatePath")+"/Web/Views/";n.state({name:"404",url:"/404",templateUrl:t+"404.html",controller:["$scope","$location","$rootScope",function(n,t,i){n.GoBack=function(){i.prevState==undefined?window.location="/":t.go(i.prevState.name,i.prevParams,{reload:!0,inherit:!1,notify:!0})}}]})}]).run(["$rootScope","$http","DataService","$timeout","$document","$uibModal","$cookies",function(n,t,i,r,u,f,e){function l(n,t){var i=new $.Deferred,r=f.open({animation:!0,templateUrl:localStorage.getItem("HtmlTemplatePath")+"/Web/Dialogs/Prompt.tmpl.html",controller:["$scope","dData","$uibModalInstance",function(n,t,i){n.Message=t.message;n.Title=t.title;n.OK=function(){i.close(0)}}],size:"sm",appendTo:angular.element(document.body),backdrop:"static",keyboard:!0,windowClass:"custom-dialog confirm-dlg",resolve:{dData:{message:n,title:t||document.title}}});return r.result.then(function(n){n==0?i.resolve(n):i.reject()}),i.promise()}var o=$("environment"),c=o.attr("showSystemError")==null?!1:o.attr("showSystemError").toLowerCase()=="true"?!0:!1,s,h;n.SessionID=o.attr("sessionID");n.HtmlTemplatePath=o.attr("tmpPath")==null||o.attr("tmpPath")==undefined?"":o.attr("tmpPath");n.SystemStatus={message:"Ready",icon:"success",moreInfo:null};t.defaults.headers.post["X-XSRF-TOKEN"]=e.get("XSRF-REQUEST-TOKEN");n.SetSystemStatus=function(t,i,r){i=="error"&&console.log(t);i=i!=undefined&&i!=null?i:"success";r=r==undefined?null:r;c==!1&&i=="error"&&(t="Internal system error, please contact administrator.",r=null);n.SystemStatus={message:t,icon:i,moreInfo:r}};n.ShowSystemLoading=function(){$("#manualLoading").css("display","block")};n.HideSystemLoading=function(){$("#manualLoading").css("display","none")};n.GetSystemIcon=function(n){var t="fa-check-circle";switch(n.toLowerCase()){case"success":t="fa-check-circle";break;case"warning":t="fa-exclamation-triangle";break;case"error":t="fa-times-circle";break;case"loading":t="fa-spinner fa-spin";break;default:t="fa-check-circle"}return t};s=document.querySelector("insys");h=s.innerHTML.trim();i.SetEncryption(h);i.SetDialog(l);s.parentNode.removeChild(s);o.remove();h=null}]);angular.module("app").controller("BaseController",["$scope","DataService","$sce","Session","$uibModal","$rootScope","$timeout","$state",function(n,t,i,r,u,f,e,o){n.ShowInfoTab=!0;n.toggleInfoTab=function(){n.ShowInfoTab=!n.ShowInfoTab};n.isChrome=!!window.chrome&&(!!window.chrome.webstore||!!window.chrome.runtime);n.isFirefox=typeof InstallTrigger!="undefined";n.isOpera=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0;n.isSafari=/constructor/i.test(window.HTMLElement)||function(n){return n.toString()==="[object SafariRemoteNotification]"}(!window.safari||typeof safari!="undefined"&&safari.pushNotification);n.theme=1;localStorage.getItem("theme")!=undefined&&(n.theme=localStorage.getItem("theme"));n.SwitchTheme=function(){var t=n.theme==1?!0:!1;t?localStorage.setItem("theme",2):localStorage.setItem("theme",1);n.loadTheme()};n.loadTheme=function(){localStorage.getItem("theme")!=undefined&&(n.theme=localStorage.getItem("theme"));n.theme==2?($("link[href='/bundles/Base-MasterCss']").remove(),$("head").append('<link href="/bundles/'+localStorage.getItem("HtmlTemplatePath").replace(/\//g,"")+'-DarkMasterCss" rel="stylesheet" />')):($("link[href='/bundles/Base-DarkMasterCss']").remove(),$("head").append('<link href="/bundles/'+localStorage.getItem("HtmlTemplatePath").replace(/\//g,"")+'-MasterCss" rel="stylesheet" />'))};n.SetIcon=function(n){var t,i;if(n!=undefined){for(t="",n=n.split(" "),i=0;i<n.length;i++)t+=n[i].substr(0,1);return t.length>2&&(t=t.substr(0,2)),t.toLowerCase()}};n.FormatDate=function(n,t){return n==null||n==""?null:moment(new Date(n)).format(t)};n.FormatCurrency=function(n){var t,i;if(n!=undefined&&n!=null){for(t=0,t=n.toString().indexOf(",")>=0?n.replace(",",""):n,t=parseFloat(t),t=t.toFixed(2),t+="",x=t.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"",i=/(\d+)(\d{3})/;i.test(x1);)x1=x1.replace(i,"$1,$2");return x1+x2}};n.SetSystemStatus=function(n,t){f.SetSystemStatus(n,t)};n.SetEncryption=function(n,i){t.SetEncryption(n,i)};n.UserRow=function(n){r.UserRow(n)};n.Dialog=function(n){return u.open({animation:!0,templateUrl:n.templateUrl||localStorage.getItem("HtmlTemplatePath")+"/Web/Dialogs/"+n.template+".tmpl.html",controller:n.controller,size:n.size||"lg",appendTo:angular.element(document.body),backdrop:"static",keyboard:!0,windowClass:"custom-dialog "+n.windowClass,resolve:n.resolve||{dData:n.data||null}})};n.Confirm=function(t,i,r){var u=new $.Deferred,f=n.Dialog({controller:["$scope","dData","$uibModalInstance",function(n,t,i){n.Message=t.message;n.Title=t.title;n.Icon=r||"info";n.Cancel=function(){i.close(1)};n.OK=function(){i.close(0)}}],template:"Confirm",size:"sm",windowClass:"confirm-dlg",data:{message:t,title:i||document.title}});return f.result.then(function(n){n==0?u.resolve(n):u.reject()}),u.promise()};n.Prompt=function(t,i,r){var u=new $.Deferred,f=n.Dialog({controller:["$scope","dData","$uibModalInstance",function(n,t,i){n.Message=t.message;n.Title=t.title;n.Icon=r||"info";n.OK=function(){i.close(0)}}],template:"Prompt",size:"sm",windowClass:"confirm-dlg",data:{message:t,title:i||document.title}});return f.result.then(function(n){n==0?u.resolve(n):u.reject()}),u.promise()};n.Request=function(i,r,u,e){return u=u==undefined||u==null?n.GetCurrentController:u,t.Post(i,r,u,e).then(function(t){if(t.Type==8)n.SetSystemStatus(t.Message,"error"),n.$apply(),o.go("404",{},{reload:!0});else return t}).fail(function(t){return console.log(i+": "+t.toString()),t.toString().replace("Error: ","")=="Session Expired."&&n.Prompt(t.toString().replace("Error: ","")).then(function(){window.location.reload()}),f.SetSystemStatus(t.toString().replace("Error: ",""),"error"),t})};n.ByteLength=function(n){return typeof n=="object"&&(n=JSON.stringify(n)),t.ByteLength(n)};n.Download=function(i,r,u,f){return t.Download(i,r,u,f).then(function(t){t!=undefined?t.Type==2?n.SetSystemStatus(t.Message,"error"):n.SetSystemStatus("Ready"):n.SetSystemStatus("Ready")}).catch(function(t,i){n.SetSystemStatus(i.toString(),"error")})};n.UrlApi=function(n){return t.UrlApi(n)};n.ActionUrl=function(n,t,i){var r,f,u,e;if(r=t.toLowerCase().indexOf("controller")>=0?"/"+t.replace("Controller","")+"/"+n:"/"+t+"/"+n,vcl.String.StartsWith(r,"/http"))return r.substr(1);if(i){f=[];u=Object.keys(i);for(e in u)f.push(u[e]+"="+i[u[e]]);r=r+"?"+f.join("&")}window.location=r};n.IsNull=function(n,t){return n==null||typeof n==typeof undefined||n==""?t:n};n.Goto=function(n,t){o.go(n,t||{},{reload:!0})};n.UploadFile=function(i,r,u,f){var o,s,e;try{return o=$.Deferred(),s="",f&&(s=' accept="'+f+'" '),e=$('<input type="file" '+(u?"multiple":"")+s+" />"),e.change(function(){setTimeout(function(){var c,s,u,y,p,l,a,v,h;try{if(e[0].files.length>10){n.SetSystemStatus("Maximum of 10 files per upload.","warning");o.reject();return}if(e[0].files.length==0){o.reject();return}if(f){for(c=!1,s=f.split(","),u=0;u<s.length;u++)if(y=s[u].trim().indexOf("*")!==-1,y){if(p=s[u].trim().split("/"),e[0].files[0].type.toLowerCase().startsWith(p[0].toLowerCase())){c=!0;break}}else if(s[u].trim().toLowerCase()==="."+e[0].files[0].name.split(".")[e[0].files[0].name.split(".").length-1].toLowerCase()){c=!0;break}if(!c){o.reject("Invalid File");return}}if(l=new FormData,r){a=Object.keys(r);for(v in a)l.append(a[v],r[a[v]])}for(h=0;h<e[0].files.length;h++)l.append("fileToUpload_"+h.toString(),e[0].files[h]);t.Upload(i,l).then(function(n,t){o.resolve(n,t,e[0].files)}).fail(function(t){var i=t.toString().substr(0,40);i.length<t.toString().length&&(i=i+"...");n.SetSystemStatus("$r.Upload "+t.toString(),"error");o.reject()})}catch(w){console.error(w);n.SetSystemStatus(w,"error")}},100)}),e.trigger("click"),o.promise()}catch(h){console.error(h)}};n.UploadFileSlim=function(t,i){var r=i||{};return r.Container=t,r.UseOriginalName||(r.UseOriginalName=!1),n.UploadFile("UploadFile",r)};n.Task=function(n,t){var i=$.Deferred();return n?n(i):e(function(){i.resolve()},t||100),i.promise()};n.WaitForElement=function(n){var t=$.Deferred(),i=0,r=function(){var u=setTimeout(function(){var f=$(n);clearTimeout(u);f.length>0?t.resolve(f):(i++,i<10?r():t.reject("Could not find Element"))},100)};return r(),t.promise()};n.SetDirtyFormToFalse=function(n){if(n!={})for(var t in n)n[t]!=undefined&&n[t].$dirty&&(n[t].$dirty=!1)};n.CompareObject=function(n,t){var i=!1;for(var r in n)if(n[r]!=t[r]){i=!0;break}return i};n.GetFileNameWithOutExtension=function(n){return vcl.Path.GetFileName(n)};n.TrustSrc=function(n){return i.trustAsResourceUrl(n)};n.StringFormat=function(n){var t=Array.prototype.slice.call(arguments,1);return n.replace(/{(\d+)}/g,function(n,i){return typeof t[i]!="undefined"?t[i]:n})};n.SQLFormat=function(n,t){var i=n;return n===null||typeof n==typeof undefined?i="NULL":n===!0||n===!1||n==="true"||n==="false"?i=n===!0||n==="true"?1:0:isNaN(n)&&(i="'"+n+(t?"%":"")+"'"),i};n.DataBank=function(n,t){if(t)r.DataBank(n,t);else return r.DataBank(n)};n.Title=function(t){document.title=t+" - "+n.Session("Company")};n.Session=function(n){return r.Session(n)};n.SessionUpdate=function(n,t){r.Update(n,t)};n.PassParameter=function(t,i,u,f){var h,s,o,c,e;try{if(t===undefined||t===null)return;if(h=function(n){return n=="NULL"?n.toLowerCase():n},s=i||r.UserRow(),u=u||"@",o=Object.keys(s),f)for(e=0;e<f.length;e++)c=f[e].split("."),t=t.replace(new RegExp("\\"+c[0]+"\\b"+c[1]+"\\b","g"),h(n.SQLFormat(s[c[1]])));for(e=0;e<o.length;e++)u instanceof Array?u.forEach(function(i){t=t.replace(new RegExp("\\"+i+"\\b"+o[e]+"\\b","g"),h(n.SQLFormat(s[o[e]])))}):t=t.replace(new RegExp("\\"+u+"\\b"+o[e]+"\\b","g"),h(n.SQLFormat(s[o[e]])));return t}catch(l){console.error(l.message,t)}};n.hasValue=function(n){return n?typeof n=="string"&&n.trim()===""?!1:!0:!1};n.SetFromSystemQueryParameter=function(t){var u,i,r,f,e;if(!n.hasValue(t))return t;for(u=vcl.Options.SystemParameters,i=0;i<u.length;i++)r=u[i],f="@"+r.Key,r.Value&&(e=r.Value.toString(),t=t.replace(f,e));return t};n.FormatColumn=function(t,i){var r=i[t];return typeof r=="string"||r instanceof String?t.toLowerCase().indexOf("datetime")!==-1&&vcl.DateTime.IsNewtonFormat(r)?r=vcl.DateTime.Format(r,"mmm dd, yyyy - hh:MM TT"):t.toLowerCase().indexOf("date")!==-1&&vcl.DateTime.IsNewtonFormat(r)?r=vcl.DateTime.Format(r,"mmm dd, yyyy"):vcl.DateTime.IsNewtonFormat(r)&&(r=vcl.DateTime.Format(r,"hh:MM TT")):r&&!isNaN(r)&&t.toLowerCase()!=="id"&&t.toLowerCase()!=="year"&&(r=n.FormatNumber(r)),r};n.FormatNumber=function(n,t){var i=parseFloat(n).toFixed(t||2).toString().split(".");return i[0]=i[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),i.join(".")};n.Compress=function(n){return LZString.compressToEncodedURIComponent(JSON.stringify(n))};n.Decompress=function(n){return JSON.parse(LZString.decompressFromEncodedURIComponent(n))};n.GetMenu=function(n){return t.GetMenu(n)};n.convertDataURIToBinary=function(n){for(var i=";base64,",e=n.indexOf(i)+i.length,o=n.substring(e),r=window.atob(o),u=r.length,f=new Uint8Array(new ArrayBuffer(u)),t=0;t<u;t++)f[t]=r.charCodeAt(t);return f};n.DefaultColumns=function(){return[{ID:0,Name:"ID",EffectiveLabel:"Reference ID"},{ID:0,Name:"Name",EffectiveLabel:"Name"},]};n.LongDate=function(n){var t=vcl.DateTime;return n!=null?t.Format(n,t.masks.inSysDateTime):null};n.LoadCombo=function(t,i,r){return n.Request("LoadCombo",{DataSource:t,filter:r,Name:i})};n.PlotDefault=function(t,i,r){return(r==0||r=="")&&Enumerable.From(i).ForEach(function(i){i.ColumnName.toLowerCase()=="id"?t[i.ColumnName]=n.IsNull(i.DefaultValue,0):i.DataType.toLowerCase()=="int"||i.DataType.toLowerCase()=="decimal"?(t[i.ColumnName]==null||t[i.ColumnName]==0||t[i.ColumnName]==undefined)&&(t[i.ColumnName]=n.IsNull(i.DefaultValue,"").indexOf("@")==0?n.Session(i.DefaultValue.substr(1)):(i.DefaultValue>=0||i.DefaultValue=="0")&&i.DefaultValue!=null?parseInt(i.DefaultValue):i.DefaultValue):i.DataType=="bit"?t[i.ColumnName]==null&&(t[i.ColumnName]=i.DefaultValue=="1"?!0:!1):t[i.ColumnName]==null&&(t[i.ColumnName]=i.DefaultValue!=null?i.DefaultValue.indexOf("@")==0?n.Session(i.DefaultValue.substr(1)):i.DefaultValue:null)}),t};n.GetMaxLength=function(t,i){return Enumerable.From(i||n.TableSchema).Where(n=>n.ColumnName==t).Select(n=>n.Length).FirstOrDefault()};n.SetMaxLengthForVarchar=function(n){var t,i,r;if(n!=undefined&&(t=n.filter(n=>n.DataType=="varchar"),console.log(t.length),i=0,r="",t.length>0))while(i<t.length)r="input[name="+t[i].ColumnName+"]",r.length>0&&$(r).prop("maxlength",t[i].Length),i++};n.SetIfRequired=function(n){if(n!=undefined){var i="",t=0;if(n.length>0)while(t<n.length)i="input[name="+n[t].ColumnName+"]",i.length>0&&($(i).prop("required",!n[t].AllowNull),$(i).parent().attr("required",!n[t].AllowNull)),t++}else console.log("TableSchema not found.")};n.regex=function(t){var i=new RegExp("^[0-9]*$");if(i.test(t)==!1){n.SetSystemStatus("doesnt match","error");return}};n.SetMaxLengthRequired=function(t){n.SetMaxLengthForVarchar(t);n.SetIfRequired(t)};n.GetTableSchema=function(t){if(t==undefined||t==null||t==""){console.log("Error","No table name defined");return}return n.Request("LoadSchema",{Table:t},"Menu")};n.RequestSchema=function(t){n.GetTableSchema(t).then(function(n){return n.Data})};n.DataSort=function(n,t,i){return n.sort(function(n,r){return n[t]<r[t]?i=="asc"?-1:1:n[t]>r[t]?i=="asc"?1:-1:0})};n.IsTabsValid=function(t,i,r){function h(n,t){$(n).scrollTop($(n).height()+$(t).offset().top);$(n).scrollLeft($(n).width()+$(t).offset().left)}var e,f,o,u,c,s;if(r=r==undefined?"":"#"+r,(i==undefined||i==null)&&(i=n.TableSchema),i.length==0||i==undefined){n.Prompt("Table Schema is undefined or empty. Please report immediately.");return}if(e=0,f=$('form[name="'+t+'"]'),f.length>0)if(o=f.find(r+'[role="tabpanel"]'),o.length==0){if(u=[],f.find("input,textarea,select:visible").not('.listing-footer select, input[type="checkbox"], .insys-filter input,.insys-filter textarea,.insys-filter select,[text-angular] textarea').each(function(n,t){var r=$(t).attr("name"),f=Enumerable.From(i).Where(function(n){return n.ColumnName.toLowerCase()==r.toLowerCase()}).FirstOrDefault();f!=undefined&&f!=null?f.AllowNull||($(t).val()==""||$(t).val()==null||$(t).val()==undefined||$(t).val()=="object:null")&&(u.indexOf(r)==-1&&u.push(r),e+=1):$(t).prop("required")&&($(t).val()==""||$(t).val()==null||$(t).val()==undefined||$(t).val()=="object:null")&&(u.indexOf(r)==-1&&u.push(r),e+=1)}),u.length>0){c=f.find("input,textarea,select:visible").not('.listing-footer select, input[type="checkbox"], .insys-filter input,.insys-filter textarea,.insys-filter select,[text-angular] textarea');setTimeout(function(){h($(".tab-content"),objError)},200);for(s in u)$(c).filter("[name="+u[s]+"]").each(function(n,t){if($(t).val()==""||$(t).val()==null||$(t).val()==undefined||$(t).val()=="object:null"){u[s]=$(t).attr("c-label")||$(t).attr("name");$(t).addClass("required");$(t).on("focus",function(){$(this).removeClass("required")})}});n.SetSystemStatus(u.join(", ")+" is required.","warning")}}else o.each(function(t,r){var l=$(r).find(".rf-header").first().text()||$(f).parent().find('ul[role="tablist"]:visible').find('a[data-target="#'+$(r).attr("id")+'"]').text(),s=null,u=[],o=null,c,t;if($(r).find("input,textarea,select:visible").not('.listing-footer select, input[type="checkbox"], .insys-filter input,.insys-filter textarea,.insys-filter select,[text-angular] textarea').each(function(n,t){var f=$(t).attr("name"),h=Enumerable.From(i).Where(function(n){return n.ColumnName.toLowerCase()==f.toLowerCase()}).FirstOrDefault();h!=undefined&&h!=null?h.AllowNull||($(t).val()==""||$(t).val()==null||$(t).val()==undefined||$(t).val()=="object:null")&&(u.indexOf(f)==-1&&u.push(f),e+=1,s=$(r),o==null&&(o=$(t))):$(t).prop("required")&&($(t).val()==""||$(t).val()==null||$(t).val()==undefined||$(t).val()=="object:null")&&(u.indexOf(f)==-1&&u.push(f),e+=1,s=$(r),o==null&&(o=$(t)))}),u.length>0){$(f).parent().find('ul[role="tablist"]:visible').find('a[data-target="#'+s.attr("id")+'"]').click();setTimeout(function(){h($(".tab-content"),o)},200);c=$(r).find("input,textarea,select:visible").not('.listing-footer select, input[type="checkbox"], .insys-filter input,.insys-filter textarea,.insys-filter select,[text-angular] textarea');for(t in u)$(c).filter("[name="+u[t]+"]").each(function(n,i){if($(i).val()==""||$(i).val()==null||$(i).val()==undefined||$(i).val()=="object:null"){u[t]=$(i).attr("c-label")||$(i).attr("name");$(i).addClass("required");$(i).on("focus",function(){$(this).removeClass("required")})}});return n.SetSystemStatus(u.join(", ")+" is required on tab "+l+".","warning"),!1}});else return!0;return e==0?!0:!1};n.GetIsRequired=function(t,i){return!Enumerable.From(i||n.TableSchema).Where(n=>n.ColumnName==t).Select(n=>n.AllowNull).FirstOrDefault()};n._CalendarMonths=[{ID:1,Code:"Jan",Name:"January"},{ID:2,Code:"Feb",Name:"February"},{ID:3,Code:"Mar",Name:"March"},{ID:4,Code:"Apr",Name:"April"},{ID:5,Code:"May",Name:"May"},{ID:6,Code:"Jun",Name:"June"},{ID:7,Code:"Jul",Name:"July"},{ID:8,Code:"Aug",Name:"August"},{ID:9,Code:"Sep",Name:"September"},{ID:10,Code:"Oct",Name:"October"},{ID:11,Code:"Nov",Name:"November"},{ID:12,Code:"Dec",Name:"December"}];n.getFilingStatusIcon=function(n){switch(n.toString().toLowerCase()){case"1":case"filed":return"fa-file-alt";case"2":case"approve":case"approved":return"fa-check-circle";case"3":case"disapprove":case"disapproved":return"fa-times-circle";case"4":case"cancel":case"cancelled":return"fa-ban";default:return"fa-file-alt"}};n.GoToState=function(n,t){o.go(n,t,{reload:!0})};n.GetAge=function(n){var t=new Date(n),i=new Date,r=i.getFullYear()-t.getFullYear();return i.getMonth()<t.getMonth()?r-=1:i.getDate()<t.getDate()&&(r-=1),r};n.GetValueFromArray=function(n,t,i){return Enumerable.From(n).Where(function(n){return n[t]==i}).FirstOrDefault()};n.RemoveDecimal=function(n){return Math.floor(n)}}]).controller("MenuController",["$scope","$rootScope",function(n,t){function i(n,t){var r=Enumerable.From(t).Where(function(t){return t.ID_Menus==n&&t.ID_MenusType!=3}).ToArray();return Enumerable.From(r).ForEach(function(n){n.Children=i(n.ID,t)}),r}n.tree=[];n.bareTree=[];n.InitMenu=function(){return n.Request("LoadMenu",{},"Menu").then(function(r){if(r.Type==2)t.SetSystemStatus(r.Message,"error");else{n.bareTree=r.Data;var u=Enumerable.From(r.Data).Where(function(n){return n.ID_Menus==null||n.ID_Menus==0}).ToArray();Enumerable.From(u).ForEach(function(n){n.Children=i(n.ID,r.Data)});n.tree=u}})}}]).controller("insysTableController",["$scope","$controller","$state","$timeout","$q",function(n,t,i,r,u){t("BaseController",{$scope:n});var e={Data:{Rows:[],Total:0},Columns:[{Name:"ID",Label:"Refrence ID",IsFreeze:!0},{Name:"Name",Label:null},],Filters:[],FilterVisible:!1,HasNew:!1,HasDelete:!1,HasEdit:!1,SortName:"ID",SortDirection:"DESC",CountPerPage:[20,60,100],Pages:[],SelectedCount:20,SelectedPage:1,openForm:null,PinnedColumns:[],ShowTable:!1,ShowPinnedHeader:!1,isLookup:!1,newForm:null,deleteRow:null,isEditable:!1,hasOpenIcon:!1,hasOpenIconClick:null,TableSchema:[],HasMultiSelect:!1,Buttons:[],SelectedRows:[]},f={},o={};n.tblOptions={};n.action=null;n.controller=null;n.SelectAllRows=!1;n.ShowPinnedHeader=!1;n.CheckAll=function(){n.SelectAllRows=!n.SelectAllRows;Enumerable.From(n.tblOptions.Data.Rows).ForEach(function(t){t.IsChecked=n.SelectAllRows})};n.CheckSelectedRow=function(n){n.IsChecked=!n.IsChecked};n.FormatTable=function(t){function u(){var f=$(t).width(),e=$(t).find(".rbGrid-column-container").width(),r=f-e,u,i;r>0&&(console.log(n.tblOptions),u=n.tblOptions.Columns.length+n.tblOptions.PinnedColumns.length,i=r/u,$(t).find(".rbGrid-pinned-container").children().each(function(n,t){$(t).hasClass("selectBox")||$(t).width($(t).width()+i)}),$(t).find(".rbGrid-column-container").children().each(function(n,t){$(t).hasClass("selectBox")||$(t).width($(t).width()+i)}))}var i=0,r=0,f;t.on("scroll",function(){var e=t.find(".rbGrid-column-label"),o=e[0].offsetTop,s=t.scrollTop(),f,u;s>o?(n.tblOptions.ShowPinnedHeader=!0,n.$apply()):(n.tblOptions.ShowPinnedHeader=!1,n.$apply());t.find(".rbGrid-sticky-container").length>0&&t.find(".rbGrid-sticky-container").css("marginTop",t.scrollTop());t.find(".rbGrid-pinned-container").length>0&&(t.find(".rbGrid-pinned-container").css("marginLeft",t.scrollLeft()).scrollTop(t.scrollTop()),t.find(".rbGrid-sticky-pinned").css("marginLeft",t.scrollLeft()));f=t.scrollLeft();i!=f&&(t.find(".rbGrid-pinned-container").hasClass("pinned-scroll")||t.find(".rbGrid-pinned-container").addClass("pinned-scroll"),i=f,i==0&&t.find(".rbGrid-pinned-container").removeClass("pinned-scroll"));u=t.scrollTop();r!=u&&i>0?(t.find(".rbGrid-sticky-pinned").hasClass("pinned-scroll")||t.find(".rbGrid-sticky-pinned").addClass("pinned-scroll"),r=u):r==u&&i>0?t.find(".rbGrid-sticky-pinned").hasClass("pinned-scroll")||t.find(".rbGrid-sticky-pinned").addClass("pinned-scroll"):i==0&&t.find(".rbGrid-sticky-pinned").removeClass("pinned-scroll")});n.tblOptions.isLookup?(f=0,new ResizeSensor(jQuery("#lookup-handle"),function(){u()})):u()};n.current={options:{},action:null,controller:null,xParams:{}};n.RefreshLoadTable=function(){n.LoadTable(n.current.options,n.current.action,n.current.controller,n.current.xParams)};n.LoadTable=function(t,i,u,s){n.tblOptions.SelectedPage=1;n.current={options:t,action:i,controller:u,xParams:s};Enumerable.From(t.Columns).Where(function(n){return n.IsFreeze==!0}).ForEach(function(n){e.PinnedColumns.push(n)});for(var h in e.PinnedColumns)h<2?t.Columns.splice(t.Columns.indexOf(e.PinnedColumns[h]),1):e.PinnedColumns.splice(h,1);return n.tblOptions=$.extend(e,t),n.action=i,n.controller=u,o=s,f={data:{SortName:n.tblOptions.SortName,SortDirection:n.tblOptions.SortDirection,Page:n.tblOptions.SelectedPage,Count:n.tblOptions.SelectedCount,Filters:n.tblOptions.Filters}},f=$.extend(f,o),n.Request(i,f||{},u).then(function(t){return t.Type!=2&&(n.tblOptions.Data=t.Data,n.BuildPage(),n.tblOptions.ShowTable=!0,n.SetupDropdownSources(),r(function(){$(".rbGrid:visible").each(function(t,i){n.FormatTable($(i))})},100)),t})};n.RefreshTable=function(){return n.SelectAllRows=!1,f={data:{SortName:n.tblOptions.SortName,SortDirection:n.tblOptions.SortDirection,Page:n.tblOptions.SelectedPage,Count:n.tblOptions.SelectedCount,Filters:n.tblOptions.Filters}},f=$.extend(f,o),n.Request(n.action,f||{},n.controller).then(function(t){t.Type==2?n.SetSystemStatus(t.Message,"error"):n.tblOptions.Data=t.Data})};n.BuildPage=function(){var t,i;for(n.tblOptions.Pages=[],t=parseInt(n.tblOptions.Data.Total/n.tblOptions.SelectedCount),t=t+(n.tblOptions.Data.Total%n.tblOptions.SelectedCount>0?1:0),t=t==0?1:t,i=0;i<t;i++)n.tblOptions.Pages.push(i+1)};n.ChangeCount=function(){n.SetSystemStatus("Loading "+n.tblOptions.SelectedCount+" rows.","loading");n.tblOptions.SelectedPage=1;n.RefreshTable().then(function(){n.BuildPage();n.SetSystemStatus("Ready");n.$apply()})};n.ChangePage=function(){n.SetSystemStatus("Loading page "+n.tblOptions.SelectedPage+".","loading");n.RefreshTable().then(function(){n.SetSystemStatus("Ready");n.$apply()})};n.newForm=function(){console.log(n.tblOptions);n.tblOptions.newForm!=null||n.tblOptions.newForm!=undefined?n.tblOptions.newForm():i.current.name.indexOf(".Form")>-1?i.go(i.current.name,{ID:0},{reload:!0}):i.go(i.current.name+".Form",{ID:0},{reload:!0})};n.deleteRow=function(t,r,u){if(n.tblOptions.deleteRow!=null)n.tblOptions.deleteRow();else{var f=n.getSelectedRows(),e={Data:f};e=$.extend(e,u);f.length>0?n.Confirm("Are you sure you want to delete ("+f.length+(f.length>1?") records?":") record?"),"Delete Record").then(function(){n.Request(t,e,r).then(function(t){t.Type==2?(n.SetSystemStatus(t.Message,"error"),n.$apply()):(n.Prompt(t.Message,"Delete Record"),i.reload())})}):n.SetSystemStatus("No record selected.","warning")}};n.deleteDetailRow=function(t,r,u,f){if(u=u==undefined?n.tblOptions:u,!u.HasDelete){n.Prompt("You are not allowed to delete record(s).");return}var e=n.getSelectedRows(u);e.length>0?n.Confirm("Are you sure you want to delete ("+e.length+(e.length>1?") records?":") record?"),"Delete Record").then(function(){var o=Enumerable.From(e).Where(function(n){return n==null||n==0}).ToArray(),h,s;if(o.length>0)for(h in o)u.Data.Rows.splice(e.indexOf(o[h]),1),e.splice(e.indexOf(o[h]),1);s={Data:e};s=$.extend(s,f);e.length>0&&n.Request(t,s,r).then(function(t){t.Type==2?(n.SetSystemStatus(t.Message,"error"),n.$apply()):(n.Prompt(t.Message,"Delete Record"),i.reload())})}):n.SetSystemStatus("No record selected.","warning")};n.openForm=function(t){n.tblOptions.openForm!=null||n.tblOptions.openForm!=undefined?n.tblOptions.openForm(t):i.go(i.current.name+".Form",{ID:t.ID},{reload:!0})};n.hasOpenIconClick=function(t){n.tblOptions.hasOpenIconClick!=null||n.tblOptions.hasOpenIconClick!=undefined?n.tblOptions.hasOpenIconClick(t):n.openForm(t)};n.FormatVal=function(n,t){if(n.toString().indexOf(".CDITI.")>-1)return n.toString().split(".CDITI.")[0];var i=[moment.ISO_8601],r=moment(n,i,!0).isValid();return r&&(n=moment(n).format(t)),n||"-"};n.Override_Return=null;n.return=function(){n.Override_Return!=null||n.Override_Return!=undefined?n.Override_Return():i.go(i.$current.parent.name,{ID:""},{reload:!0})};n.getSelectedRows=function(t){return t==undefined||t==null?Enumerable.From(n.tblOptions.Data.Rows).Where(function(n){return n.IsChecked==!0}).Select(function(n){return n.ID}).ToArray():Enumerable.From(t.Data.Rows).Where(function(n){return n.IsChecked==!0}).Select(function(n){return n.ID}).ToArray()};n.getDetailedSelectedRows=function(t){return t==undefined||t==null?Enumerable.From(n.tblOptions.Data.Rows).Where(function(n){return n.IsChecked==!0}).ToArray():Enumerable.From(t.Data.Rows).Where(function(n){return n.IsChecked==!0}).ToArray()};n.prev=function(){n.tblOptions.SelectedPage>1&&(n.tblOptions.SelectedPage--,n.ChangePage())};n.next=function(){n.tblOptions.SelectedPage<n.tblOptions.Pages.length&&(n.tblOptions.SelectedPage++,n.ChangePage())};n.ShowFilter=function(){n.tblOptions.FilterVisible=!n.tblOptions.FilterVisible};n.IsBoolean=function(n){return typeof n=="boolean"};n.setSortIcon=function(t){return n.tblOptions.SortName==t?n.tblOptions.SortDirection.toLowerCase()=="asc"?"fa-sort-up":"fa-sort-down":"fa-sort"};n.sortData=function(t,i){n.tblOptions.SortName=t;n.tblOptions.SortDirection.toLowerCase()=="asc"?(n.tblOptions.SortDirection="DESC",n.SetSystemStatus("Sorting "+(i||t)+" descending.","loading")):(n.tblOptions.SortDirection="ASC",n.SetSystemStatus("Sorting "+(i||t)+" ascending.","loading"));n.RefreshLoadTable().then(function(){n.SetSystemStatus("Ready")})};n.GetArrayValue=function(n,t,i){return Enumerable.From(n).Where(function(){return x[t]==i}).FirstOrDefault()};n.SetupDropdownSources=function(){if(n.tblOptions.isEditable&&(n.DropdownSources==undefined&&(n.DropdownSources=[]),n.GetDropdownSource=function(t){var i=Enumerable.From(n.DropdownSources).Where(n=>n.Name==t).ToArray();return i.length>0?i[0].Data:[]},n.DropdownSources.length==0)){var t=Enumerable.From(n.tblOptions.Columns).Where(t=>n.IsNull(t.ControlType,"").toLowerCase()=="select").ToArray();angular.forEach(t,function(t){var i={Name:t.Name,Source:n.Request(t.Options.method,t.Options.parameter,t.Options.controller),Data:[]};n.DropdownSources.push(i)});n.DropdownSources.length>0&&u.all(Enumerable.From(n.DropdownSources).Select(n=>n.Source).ToArray()).then(function(t){angular.forEach(t,function(t,i){t.Type==2?n.SetSystemStatus(t.Message,"error"):n.DropdownSources[i].Data=t.Data.Rows})})}}}]).controller("insysTreeController",["$scope",function(n){n.RecursiveTree=function(t,i,r,u,f,e,o){u==undefined&&(u=null);var s=[];return f!=undefined&&e!=undefined?Enumerable.From(t).Where(n=>n[i]==u&&n[f]==o).ForEach(function(u){var o=Enumerable.From(t).Count(n=>n[i]==u[r]&&n[f]==u[e]);u.Children=o>0?n.RecursiveTree(t,i,r,u[r],f,e,u[e]):[];s.push(u)}):Enumerable.From(t).Where(n=>n[i]==u).ForEach(function(u){var f=Enumerable.From(t).Count(n=>n[i]==u[r]);u.Children=f>0?n.RecursiveTree(t,i,r,u[r]):[];s.push(u)}),s}}]).controller("insysDatePickerController",["$scope","$element","$attrs","$compile",function(n,t,i,r){n.data={};n.data.currentMonth=null;n.data.currentYear=null;n.data.currentDate=null;n.data.selectedValue=null;n.today=new Date;n.data.currentMonth=n.today.getMonth();n.data.currentYear=n.today.getFullYear();n.data.currentDate=n.today.getDate();n.firstDay=new Date(n.data.currentYear,n.data.currentMonth).getDay();n.months=[{ID:0,Name:"January"},{ID:1,Name:"February"},{ID:2,Name:"March"},{ID:3,Name:"April"},{ID:4,Name:"May"},{ID:5,Name:"June"},{ID:6,Name:"July"},{ID:7,Name:"August"},{ID:8,Name:"September"},{ID:9,Name:"October"},{ID:10,Name:"November"},{ID:11,Name:"December"},];n.years=[];n.generateYears=function(t,i){n.years=[];for(var r=t;r<i;r++)n.years.push(r)};n.next=function(){n.data.currentYear=n.data.currentMonth===11?n.data.currentYear+1:n.data.currentYear;n.data.currentMonth=(n.data.currentMonth+1)%12;n.updateFirstDay();n.updateCalendar(n.data.currentMonth,n.data.currentDate,n.data.currentYear)};n.previous=function(){n.data.currentYear=n.data.currentMonth===0?n.data.currentYear-1:n.data.currentYear;n.data.currentMonth=n.data.currentMonth===0?11:n.data.currentMonth-1;n.updateFirstDay();n.updateCalendar(n.data.currentMonth,n.data.currentDate,n.data.currentYear)};n.jump=function(){n.updateFirstDay();n.updateCalendar(n.data.currentMonth,n.data.currentDate,n.data.currentYear)};n.goToday=function(){n.updateCalendar(n.today.getMonth(),n.today.getDate(),n.today.getFullYear());n.updateFirstDay()};n.getMinValue=function(){return n.data.minValue};n.updateCalendar=function(t,i,r){n.IsDisabled(i)||(n.data.currentMonth=t,n.data.currentYear=r,n.data.currentDate=i,n.data.selectedValue=new Date(r,t,[i]))};n.updateFirstDay=function(){n.firstDay=new Date(n.data.currentYear,n.data.currentMonth).getDay()};n.generateTemplate=function(){return'<div id="insysDatePicker"><div class="idp-header"><div class="idp-select"> <select name="insysDatePicker-month" ng-model="data.currentMonth" id="insysDatePicker-month" ng-change="jump()" ng-options="item.ID as item.Name for item in months"><\/select> <select name="insysDatePicker-year" ng-model="data.currentYear" id="insysDatePicker-year" ng-change="jump()" ng-options="item for item in years"><\/select><\/div><div class="idp-btn"> <i id="insysDatePicker-previous" class="fa fa-chevron-left" ng-click="previous()" title="Previous"><\/i> <i id="insysDatePicker-next" class="fa fa-chevron-right" ng-click="next()" title="Next"><\/i> <i id="insysDatePicker-today" class="fa fa-calendar" ng-click="goToday()" title="Current Day"><\/i><\/div><\/div><div class="idp-body"><table><thead><tr><th>Sun<\/th><th>Mon<\/th><th>Tue<\/th><th>Wed<\/th><th>Thu<\/th><th>Fri<\/th><th>Sat<\/th><\/tr><\/thead><tbody id="insysDatePicker-body"><tr><td ng-repeat="n in [].constructor(firstDay) track by $index"><\/td><td ng-class="{\'bg-info\': IsDateActive($index + 1), \'disabled\': IsDisabled($index + 1)}" ng-mouseup="getCalendarValue($index + 1)" ng-repeat="n in [].constructor(7 - firstDay) track by $index" ng-bind="$index + 1"><\/td><\/tr><tr><td ng-class="{\'bg-info\': IsDateActive($index + (8-firstDay)), \'disabled\': IsDisabled($index + (8-firstDay))}" ng-mouseup="getCalendarValue($index + (8-firstDay))" ng-repeat="n in [].constructor(7) track by $index" ng-bind="$index + (8-firstDay)"><\/td><\/tr><tr><td ng-class="{\'bg-info\': IsDateActive($index + (8-firstDay) + 7), \'disabled\': IsDisabled($index + (8-firstDay) + 7)}" ng-mouseup="getCalendarValue($index + (8-firstDay) + 7)" ng-repeat="n in [].constructor(7) track by $index" ng-bind="$index + (8-firstDay) + 7"><\/td><\/tr><tr><td ng-class="{\'bg-info\': IsDateActive($index + (8-firstDay) + 14), \'disabled\': IsDisabled($index + (8-firstDay) + 14)}" ng-mouseup="getCalendarValue($index + (8-firstDay) + 14)" ng-repeat="n in [].constructor(7) track by $index" ng-bind="$index + (8-firstDay) + 14"><\/td><\/tr><tr><td ng-class="{\'bg-info\': IsDateActive($index + (8-firstDay) + 21), \'disabled\': IsDisabled($index + (8-firstDay) + 21)}" ng-if="($index + (8-firstDay) + 20) < daysInMonth(data.currentMonth, data.currentYear)" ng-mouseup="getCalendarValue($index + (8-firstDay) + 21)" ng-repeat="n in [].constructor(7) track by $index" ng-bind="$index + (8-firstDay) + 21"><\/td><\/tr><tr><td ng-class="{\'bg-info\': IsDateActive($index + (8-firstDay) + 28), \'disabled\': IsDisabled($index + (8-firstDay) + 28)}" ng-if="($index + (8-firstDay) + 27) < daysInMonth(data.currentMonth, data.currentYear)" ng-mouseup="getCalendarValue($index + (8-firstDay) + 28)" ng-repeat="n in [].constructor(7) track by $index" ng-bind="$index + (8-firstDay) + 28"><\/td><\/tr><\/tbody><\/table><\/div><\/div>'};n.daysInMonth=function(n,t){return 32-new Date(t,n,32).getDate()};n.generateYears(1990,n.today.getFullYear()+11);n.getCalendarValue=function(t){n.IsDisabled(t)||n.updateCalendar(n.data.currentMonth,t,n.data.currentYear)};n.IsDisabled=function(t){var i=!1,r=!1,u=new Date(new Date(n.data.currentYear,n.data.currentMonth,[t]).setHours(0,0,0,0)),f,e;return n.ngMin!=undefined&&n.ngMin!=""&&n.ngMin!=null?(f=new Date(n.ngMin),i=u<f?!0:!1):i=!1,n.ngMax!=undefined&&n.ngMax!=""&&n.ngMax!=null?(e=new Date(n.ngMax),r=u>e?!0:!1):r=!1,i||r};n.IsDateActive=function(t){return n.IsDisabled(t)?!1:t===n.data.currentDate?!0:void 0};$(document).mousedown(function(n){var t=$("#insysDatePicker");t.is(n.target)||t.has(n.target).length!==0||$("#insysDatePicker").remove()});t.on("mouseup",function(){var r,u;if($("#insysDatePicker").length>0){var e=$("#insysDatePicker").width(),o=$("#insysDatePicker").height(),n=$(t).parent(),f=n.offset().left,s=n.offset().top,i=s+n.height();f+e>$(window).width()&&(r=n.offset().left+n.width(),f=r-e);s+o>$(window).height()&&(r=n.offset().top,i=i-(i+o-r)-10);u=$("#insysDatePicker");u.removeAttr("style");u[0].style.top=i+"px";u[0].style.left=f+"px"}});t.on("focus",function(){var u,f,t;i.readonly||i.disabled||(u=r(n.generateTemplate())(n),f=$("body").find("#insysDatePicker"),f.length==0?$("body").append(u):f.remove(),$("body").append(u),n.ngModel.$modelValue!=null&&n.ngModel.$modelValue!=""?(t=new Date(n.ngModel.$modelValue),n.updateCalendar(t.getMonth(),t.getDate(),t.getFullYear())):n.updateCalendar(n.today.getMonth(),n.today.getDate(),n.today.getFullYear()),n.$watch("data.selectedValue",function(){n.ngModel.$setViewValue(moment(new Date(n.data.selectedValue)).format(n.textFormat||"MM/DD/YYYY"));n.ngModel.$render()}),n.$apply())})}]).controller("insysTimePickerController",["$scope","$element","$attrs","$compile",function(n,t){n.data={};n.data.currentHour=null;n.data.currentMinute=null;n.data.currentFormat=null;n.data.selectedValue=null;n.hours=["12","01","02","03","04","05","06","07","08","09","10","11"];n.minutes=[];n.formats=["AM","PM"];for(var i=0;i<60;i++)i>=0&&i<=9&&(i="0"+i.toString()),n.minutes.push(i.toString());n.jump=function(){n.data.currentHour!=null&&n.data.currentMinute!=null&&n.data.currentFormat!=null&&n.updateClock(n.data.currentHour,n.data.currentMinute,n.data.currentFormat)};n.updateClock=function(t,i,r){t=t>12?t-12:t;n.data.currentHour=parseInt(t)<10?"0"+parseInt(t):t.toString();n.data.currentMinute=parseInt(i)<10?"0"+parseInt(i):i.toString();n.data.currentFormat=r;n.data.selectedValue=(parseInt(n.data.currentHour)<10?"0"+parseInt(n.data.currentHour):n.data.currentHour.toString())+":"+n.data.currentMinute+" "+n.data.currentFormat};n.IsDisabledTime=function(t,i,r){if(n.ngMin!=undefined&&n.ngMin!=null&&n.ngMin!=""){var f=new Date,e=new Date,u=n.ngMin.replace(" AM","").replace(" PM","").split(":"),o=r.toLowerCase()=="pm"?parseInt(t)==12?0:12:0,s=n.ngMin.split(" ")[n.ngMin.split(" ").length-1].toLowerCase()=="pm"?parseInt(u[0])==12?0:12:0;return f.setHours(parseInt(t)+o,parseInt(i)),e.setHours(parseInt(u[0])+s,parseInt(u[1])),f<e?!0:!1}return!1};$(document).mousedown(function(n){var t=$("#insysTimePicker");t.is(n.target)||t.has(n.target).length!==0||$("#insysTimePicker").remove()});t.on("mouseup",function(){var r,u;if($("#insysTimePicker").length>0){var e=$("#insysTimePicker").width(),o=$("#insysTimePicker").height(),n=$(t),f=n.offset().left,s=n.offset().top,i=s+n.height();f+e>$(window).width()&&(r=n.offset().left+n.width(),f=r-e);s+o>$(window).height()?(r=n.offset().top,i=i-(i+o-r)-(n.height()+5)):i=i+10;u=$("#insysTimePicker");u.removeAttr("style");u[0].style.top=i+"px";u[0].style.left=f+"px"}})}]).controller("clientNotificationController",["$scope","Notification","$state",function(n,t,i){function r(){n.UnSeenNotification=Enumerable.From(n.Notifications).Where(function(n){return n.IsSeen==!1}).ToArray()}function u(){n.SeenNotification=Enumerable.From(n.Notifications).Where(function(n){return n.IsSeen==!0}).ToArray()}function f(){n.Request("LoadNotification",{},"Index",!0).then(function(t){t.Type==2?n.SetSystemStatus(t.Message,"error"):(n.Notifications=t.Data,r(),u(),n.$apply(),n.hub.start().then(function(){console.log("hub connected");n.hub.invoke("Register",n.SessionID,n.Session("ID_User")).catch(function(t){n.SetSystemStatus(t.toString(),"error")})}).catch(function(n){console.log(n.toString());setTimeout(function(){f()},6e4)}))})}n.Notifications=[];n.ProcessNotifications=[];n.UnSeenNotification=[];n.SeenNotification=[];n.NotificationOnClickEvent={};n.hub=null;n.LoadNotification=function(){n.hub=(new signalR.HubConnectionBuilder).withUrl(n.Session("WebNotificationServer")+"/webNotificationHub").configureLogging(signalR.LogLevel.Error).build();n.hub.on("logout",function(){n.Prompt("Your account has been logged in from another device.").then(function(){n.Logoff()})});n.hub.on("newNotification",function(i){i!=null&&i!=""&&i!=undefined&&(i=JSON.parse(i),n.Notifications.unshift(i),t({message:i.Content,title:i.Title,delay:5e3}),r(),u(),n.$apply())});n.hub.on("processNotification",function(t){if(t!=null&&t!=""&&t!=undefined){t=JSON.parse(t);var i=Enumerable.From(n.ProcessNotifications).Select(function(n){return n.ID}).IndexOf(t.ID);i>-1?n.ProcessNotifications[i]=t:n.ProcessNotifications.push(t);n.$apply()}});n.hub.onclose(function(){console.log("reconnecting to hub...");f()});f()};n.SeeNotification=function(t){return t.IsSeen?n.Task().then(function(){return{Type:1}}):(t.IsSeen=!0,n.Request("SeeNotification",{ID:t.ID},"Index",!0).then(function(t){return t.Type==2?(n.SetSystemStatus(t.Message,"error"),t):(r(),u(),t)}))};n.UpdateNotification=function(t,r,u){n.SeeNotification(t).then(function(f){if(f.Type==2)n.SetSystemStatus(f.Message,"error");else if(u!=null&&u!=""&&u!=undefined)u.indexOf(".Form")>-1?i.go(u,{ID:t.ReferenceID},{reload:!0}):i.go(u,{},{reload:!0});else switch(t.ID_WebNotificationTypes){case 1:if(r==undefined){n.Prompt(t.Content,t.Title);break}else if(r[1]==undefined){n.Prompt(t.Content,t.Title);break}r[1].Trigger(t);break;case 2:if(r==undefined){n.Prompt(t.Content,t.Title);break}else if(r[2]==undefined){n.Prompt(t.Content,t.Title);break}r[2].Trigger(t);break;case 1004:if(r==undefined){n.Prompt(t.Content,t.Title);break}else if(r[1004]==undefined){n.Prompt(t.Content,t.Title);break}r[1004].Trigger(t);break;default:n.Prompt(t.Content,t.Title)}})}}]).controller("insysReportController",["$scope","$controller",function(n,t){t("BaseController",{$scope:n});n.LoadReport=function(t,i,r){return n.Request(t,i,r)};n.GenerateExcel=function(t,i,r){n.Request(t,i,r).then(function(t){t.Type==2?(n.SetSystemStatus(t.Message,"error"),n.$apply()):n.Download(t.Data,"Files",t.Data.replace(".xlsx","").replace(".xls",""))})}}]).controller("insysForm",["$scope",function(n){n.form={}}]);angular.module("app").provider("DataService",function(){var i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),t=!1||!!document.documentMode,r=!t&&!!window.StyleMedia,n=this;return n.Controller="Action",n.AppName="Web",n.Encryption={Key:null,Salt:null,IP:null,Epoch:null,UID:null},n.Dialog=null,n.ResultAdapter=function(t){var r={},i=t,u,f,e;if(typeof i=="string"&&(u=n.Base64Decode(LZString.decompressFromBase64(unescape(i))),nData=u,i=JSON.parse(nData)),i.status===1)if(i.errorMsg=="Session Expired.")n.Dialog(i.errorMsg).then(function(){window.location.reload()});else throw new Error(i.errorMsg);return typeof i.resultSet=="number"||typeof i.resultSet=="object"?r.ResultSet=i.resultSet:i.resultSet&&(f=n.Base64Decode(i.resultSet),e=NickCrypt.Decrypt(f,n.Encryption.Key,n.Encryption.Salt),r.ResultSet=JSON.parse(e)),r.Status=i.status,r.ErrorMsg=i.errorMsg,r.data=t,r.ResultSet.Message=="Session Expired."&&n.Dialog(r.ResultSet.Message).then(function(){window.location.reload()}),r},n.EncryptData=function(t,i){var r=JSON.stringify(i||{}),u;return r=NickCrypt.Encrypt(r,n.Encryption.Key,n.Encryption.Salt),u=n.GenerateToken(),{Key:u,Data:r}},n.GenerateToken=function(){var t=(new Date).getTime()/1e3|0,i=[n.Encryption.UID,n.Encryption.IP,t].join(":"),r=NickCrypt.Encrypt(i,n.Encryption.Key,n.Encryption.Salt);return n.Base64Encode(r)},n.Base64Decode=function(n,t){(t==null||t==undefined)&&(t="utf-8");var i=base64js.toByteArray(n);return new(TextDecoder||TextDecoderLite)(t).decode(i)},n.Base64Encode=function(n,t){(t==null||t==undefined)&&(t="utf-8");var i=new(TextEncoder||TextEncoderLite)(t).encode(n);return base64js.fromByteArray(i)},{SetDefaultController:function(t){n.Controller=t},SetAppName:function(t){n.AppName=t},$get:["$http","$q",function(t){return{SetController:function(t){n.Controller=t},GetController:function(){return n.Controller},SetEncryption:function(t){var o=n.Base64Decode(t),i=o.split(":"),u=LZString.decompressFromUTF16(i[2]),f=LZString.decompressFromUTF16(i[3]),e=NickCrypt.Decrypt(i[4],u,f),r;if(e==null)throw new Error("Invalid Token");r=e.split(":");n.Encryption={Key:u,Salt:f,IP:r[0],Epoch:r[1],UID:i[0]}},Post:function(i,r,u,f){var e=$.Deferred(),h=window.VirtualPath||"",o=n.EncryptData(i,r),s={url:h+"/api/"+(u||n.Controller)+"/"+i,method:"POST",data:encodeURI(LZString.compressToBase64(o.Data)),dataType:"json",disableInterceptor:f==undefined?!1:f,headers:{"Api-Key":o.Key}};return console.log(s),t(s).then(function(t){try{var i=n.ResultAdapter(t.data);e.resolve(i.ResultSet,i.Status)}catch(r){e.reject(r)}}).catch(e.reject),e.promise()},ByteLength:function(n){for(var t,r=n.length,i=n.length-1;i>=0;i--)t=n.charCodeAt(i),t>127&&t<=2047?r++:t>2047&&t<=65535&&(r+=2),t>=56320&&t<=57343&&i--;return r},UrlApi:function(t){var i=window.VirtualPath||"";return i+"/api/"+n.Controller+"/"+t},Upload:function(i,r){var u=$.Deferred(),f=window.VirtualPath||"",e=n.EncryptData(name,null);return t.post(f+"/api/Upload/"+i,r,{headers:{"Content-Type":undefined,"Api-Key":e.Key},transformRequest:function(n){return n}}).then(function(t){try{var i=n.ResultAdapter(t.data);u.resolve(i.ResultSet,i.Status)}catch(r){u.reject(r)}}).catch(u.reject),u.promise()},Download:function(n,t,i,r){var u=this,f={folder:t,fileName:n,displayName:i};return this.Post("DownloadFile",f,"Download").then(function(f){return f.Type==2?f:u.DownloadFile(n,t,i,r)})},DownloadFile:function(i,r,u,f){var o=window.VirtualPath||"",s={folder:r,fileName:i,displayName:u,contentType:f},e=n.EncryptData("DownloadFile",s),h={url:o+"/api/Download/FetchFile",method:"POST",data:encodeURI(LZString.compressToBase64(e.Data)),dataType:"json",headers:{"Api-Key":e.Key},responseType:"arraybuffer"};return t(h).then(function(n){var r,f,a,e,c,s,u,l,t,h;try{r=null;f=n.headers("content-disposition");f&&f.indexOf("attachment")!==-1&&(a=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/,e=a.exec(f),e!=null&&e[1]&&(r=e[1].replace(/['"]/g,"")));var v="application/octet-stream",i=!1,y=n.headers("content-type")||v;try{if(console.log("Trying saveBlob method ..."),t=new Blob([n.data],{type:y}),navigator.msSaveBlob)navigator.msSaveBlob(t,r);else{if(c=navigator.webkitSaveBlob||navigator.mozSaveBlob||navigator.saveBlob,c===undefined)throw"Not supported";c(t,r)}console.log("saveBlob succeeded");i=!0}catch(o){console.log("saveBlob method failed with the following exception:");console.log(o)}if(!i&&(s=window.URL||window.webkitURL||window.mozURL||window.msURL,s)){if(u=document.createElement("a"),"download"in u)try{console.log("Trying download link method with simulated click ...");t=new Blob([n.data],{type:y});h=s.createObjectURL(t);u.setAttribute("href",h);u.setAttribute("download",r);l=document.createEvent("MouseEvents");l.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null);u.dispatchEvent(l);console.log("Download link method with simulated click succeeded");i=!0}catch(o){console.log("Download link method with simulated click failed with the following exception:");console.log(o)}if(!i)try{console.log("Trying download link method with window.location ...");t=new Blob([n.data],{type:v});h=s.createObjectURL(t);window.location=h;console.log("Download link method with window.location succeeded");i=!0}catch(o){console.log("Download link method with window.location failed with the following exception:");console.log(o)}}i||(console.log("No methods worked for saving the arraybuffer, using last resort window.open"),window.open(httpPath,"_blank",""))}catch(o){console.log(o)}})},GetMenu:function(n){return this.Post("GetMenu",{ID_Menu:n})},AppName:n.AppName,SetDialog:function(t){n.Dialog=t}}}]}}).factory("Session",function(){var n=this;return n.DataBank={},n.SessionData=angular.module("app").Session||{},{UserRow:function(t){if(t)n.SessionData=t;else return n.SessionData},Session:function(t){return n.SessionData[t]},Length:function(){return Object.keys(n.SessionData).length},Clear:function(){n.SessionData={}},Update:function(t,i){n.SessionData[t]!=undefined&&(n.SessionData[t]=i)}}}).factory("$Invoker",function(){return{events:{},group:function(n){var t=this;return t.events[n]==null&&(t.events[n]=[]),{on:function(i,r){t.on(n,i,r)},invoke:function(i){try{var r=[],u=Array.prototype.slice.call(arguments,1);return t.events[n].forEach(function(n){i===n.Name&&r.push(n.Action.apply(this,u))}),$.when.apply(undefined,r).promise().then(function(){return Array.prototype.slice.call(arguments,0)}).fail(function(n){console.error(n)})}catch(f){console.error(i,f);throw new Error("Method "+i+" not found");}},all:function(n){var i;try{var r=[],f=Array.prototype.slice.call(arguments,1),u=Object.keys(t.events);for(i=0;i<u.length;i++)t.events[u[i]].forEach(function(t){n===t.Name&&r.push(t.Action.apply(this,f))});return $.when.apply(undefined,r).promise().then(function(){return Array.prototype.slice.call(arguments,0)}).fail(function(n){console.error(n)})}catch(e){console.error(n,e);throw new Error("Method "+n+" not found");}},clear:function(){t.clear(n)}}},on:function(n,t,i){var r=this;this.events[n].push({Name:t,Action:i})},invoke:function(n,t){try{var i=[],r=Array.prototype.slice.call(arguments,2);return this.events[n].forEach(function(n){t===n.Name&&i.push(n.Action.apply(this,r))}),$.when.apply(undefined,i).promise().then(function(){return Array.prototype.slice.call(arguments,0)}).fail(function(n){console.error(n)})}catch(u){console.error(t,u);throw new Error("Method "+t+" not found");}},clear:function(n){delete this.events[n]}}}).filter("nospace",function(){return function(n){return n?n.replace(/ /g,""):""}}).filter("humanizeDoc",function(){return function(n){if(n)return n.type==="directive"?n.name.replace(/([A-Z])/g,function(n){return"-"+n.toLowerCase()}):n.label||n.name}});var baseUrl=localStorage.getItem("HtmlTemplatePath")+"/Web/",wcOverlayDirective=function(n,t,i,r,u){return{restrict:"EA",transclude:!0,s:{wcOverlayDelay:"@"},templateUrl:baseUrl+"Directives/overlayLoading.tmpl.html",link:function(f){function a(){v();s=document.getElementById("overlay-container")}function v(){r.request=function(t){return(t.disableInterceptor==undefined||t.disableInterceptor==!1)&&l(),t||n.when(t)};r.response=function(t){return o(),t||n.when(t)};r.responseError=function(t){return o(),f.SetSystemStatus("Error occurred. Contact system administrator.","error"),t||n.when(t)}}function l(){e.push({});e.length==1&&(h=t(function(){e.length&&y()},f.wcOverlayDelay?f.wcOverlayDelay:300))}function o(){e.pop();e.length==0&&(c=t(function(){e.length==0&&(p(),c&&t.cancel(c))},f.wcOverlayDelay?f.wcOverlayDelay:300))}function y(){var n=0,t=0;i.innerWidth?(n=i.innerWidth,t=i.innerHeight):document.documentElement.clientWidth==0?(n=document.body.clientWidth,t=document.body.clientHeight):(n=document.documentElement.clientWidth,t=document.documentElement.clientHeight);s.style.display="block"}function p(){h&&t.cancel(h);s.style.display="none"}var w;u("BaseController",{$scope:f});var s=null,h=null,c=null,e=[];a();w=function(){var n=null;return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle:typeof document.body.currentStyle!="undefined"&&(n=function(n){return n.currentStyle}),function(t,i){return n(t,null)[i]}}()}}},httpProvider=function(n){n.interceptors.push("httpInterceptor")},httpInterceptor=function(){return{}},authHttpResponseInterceptor=function(n){return{response:function(t){return t.status===401&&console.log(t),t||n.when(t)},responseError:function(t){var i;return t.status===400&&(t.data="Invalid Token."),t.status===401&&console.log(t),t.status===404?t.config.method=="POST"?(i=t.config.url.split("/"),t.data="Method "+i[i.length-1]+" not found.","error"):t.data="Page not found.":t.status===500&&(t.config.method=="POST"?(i=t.config.url.split("/"),t.data="Internal server error on "+i[i.length-1]+"."):t.data="Internal server error."),n.reject(t.data)}}},httpAuthProvider=function(n){n.interceptors.push("authHttpResponseInterceptor")};angular.module("app").factory("httpInterceptor",httpInterceptor).config(["$httpProvider",httpProvider]).directive("wcOverlay",["$q","$timeout","$window","httpInterceptor","$controller",wcOverlayDirective]).factory("authHttpResponseInterceptor",["$q","$location","$timeout","$injector","$rootScope",authHttpResponseInterceptor]).config(["$httpProvider",httpAuthProvider]).directive("insysMenu",["$compile","$state","$rootScope",function(n,t,i){return{templateUrl:baseUrl+"Directives/insysMenu.tmpl.html",restrict:"E",replace:!0,transclude:!0,scope:{treeData:"="},compile:function(r,u,f){var o=r.contents().remove(),e;return function(r,u){r.$watch("treeData",function(n){r.tree=n});r.openChild=function(n){n.IsOpen=!n.IsOpen;n.Children.length==0&&(i.SetSystemStatus("Loading "+n.Name,"loading"),r.gotoLink(n.Code.replace(new RegExp(" ","g"),"-")))};r.checkActiveMenu=function(n){var i=n.Code.replace(new RegExp(" ","g"),"-");return i==t.current.name.replace(".Form","")?!0:!1};r.gotoLink=function(n){try{t.go(n,{ID:""},{reload:!0})}catch(r){i.SetSystemStatus("Page not found.","error");t.go("404")}};e||(e=n(o,f));e(r,function(n){u.append(n)})}}}}]).directive("formatDate",[function(){return{require:"ngModel",restrict:"A",link:function(n,t,i,r){r.$formatters.push(function(n){return new Date(n)})}}}]).directive("includeReplace",[function(){return{require:"ngInclude",restrict:"A",link:function(n,t){t.replaceWith(t.children())}}}]).directive("insysLookup",["$controller","$compile",function(n,t){return{restrict:"A",scope:{lookupOptions:"=",lookupData:"=",isRequired:"=?",isDisabled:"=?",cascade:"&?",isGrid:"=?"},templateUrl:baseUrl+"Directives/insysLookup.tmpl.html",replace:!0,link:function(i){n("insysTableController",{$scope:i});i.tblOptions={};i.$watch("lookupOptions",function(n){if(n!=null){if(n.tblOptions==undefined)return;i.tblOptions=n.tblOptions;i.tblOptions.isLookup=!0}},!0);i.$watch("lookupData",function(n,t){n.model[i.lookupData.valueContainer]!=t.model[i.lookupData.valueContainer]&&n.model[i.lookupData.valueContainer]==null&&(i.lookupData.model[i.lookupData.displayContainer]=null)},!0);i.disable=function(n){n.preventDefault()};i.clear=function(){i.lookupData.model[i.lookupData.valueContainer]=null;i.lookupData.model[i.lookupData.displayContainer]=null};i.openForm=function(n){i.lookupData.model[i.lookupData.valueContainer]=n[i.lookupData.targetValue];i.lookupData.model[i.lookupData.displayContainer]=n[i.lookupData.targetDisplay];i.cascade!=undefined&&i.cascade({row:n,model:i.lookupData.model})};i.openLookup=function(n){var e,s,r;if(n=n.currentTarget,$("#lookup-handle").length==0){var h=$(n).offset().left+$(n).width(),o=$(n).offset().top,u=h-$(n).parent().parent().width()+$(n).width(),f=o+$(n).parent().parent().height()+5;if(u+400>$(window).width()&&(e=$(n).parent().parent().offset().left+$(n).parent().parent().width(),u=u-(u+400-e)),o+305>$(window).height()&&(e=$(n).parent().parent().offset().top,f=f-(f+305-e)),s=localStorage.getItem("HtmlTemplatePath"),$("body").append(t('<div id="lookup-handle" class="lookup-table"><div id="lookup-handleheader"><div class="lookup-title">'+i.lookupData.label+'<\/div><i class="fas fa-ellipsis-v"><\/div><div ng-include="\''+s+"/Web/Directives/insysTable.tmpl.html'\" include-replace><\/div><\/div>")(i)),r=$("#lookup-handle"),r.removeAttr("style"),r[0].style.top=f+"px",r[0].style.left=u+"px",i.SetSystemStatus("Loading lookup","loading"),i.LoadTable(i.tblOptions,i.lookupOptions.method,i.lookupOptions.controller,i.lookupOptions.parameter).then(function(n){n.Type==2?i.SetSystemStatus(n.Message,"error"):i.SetSystemStatus("Ready");i.$apply()}),r.length>0){function n(n){function f(n){n=n||window.event;n.preventDefault();t=n.clientX;i=n.clientY;document.onmouseup=o;document.onmousemove=e}function e(f){f=f||window.event;f.preventDefault();r=t-f.clientX;u=i-f.clientY;t=f.clientX;i=f.clientY;n.style.top=n.offsetTop-u+"px";n.style.left=n.offsetLeft-r+"px"}function o(){document.onmousemove=null}var r=0,u=0,t=0,i=0;document.getElementById(n.id+"header")?document.getElementById(n.id+"header").onmousedown=f:n.onmousedown=f}n(r[0]);$(document).on("mouseup",function(n){$(n.target).closest("#lookup-handle").length===0&&$("#lookup-handle").remove()})}}}}}}]).directive("insysTree",["$compile",function(n){return{restrict:"A",scope:{insysTree:"=",displayColumn:"=",getSelected:"&",allowCheck:"=?"},transclude:!0,replace:!0,templateUrl:baseUrl+"Directives/insysTree.tmpl.html",compile:function(t,i,r){var f=t.contents().remove(),u;return function(t,i){t.allowCheck=t.allowCheck==undefined?!0:t.allowCheck;u||(u=n(f,r));u(t,function(n){i.append(n)});t.ToggleChildren=function(n){n.ShowChild=!n.ShowChild};t.$watch("insysTree",function(){Enumerable.From(t.insysTree).ForEach(function(n){n.Children==undefined&&(n.Children=[])})});t.getNodeState=function(n){return n.ShowChild==!1||n.ShowChild==undefined?"fa-plus-square":"fa-minus-square"};t.selectNode=function(n){n.Children.length==0&&(t.getSelected({data:n}),$(".tree-li").removeClass("tree-selected"),$("#tree-"+n.ID_Menus).addClass("tree-selected"))}}}}}]).directive("insysFilter",["$controller","$q",function(n,t){return{restrict:"E",replace:!0,templateUrl:baseUrl+"Directives/insysFilter.tmpl.html",link:function(n){n.DropdownSources==undefined&&(n.DropdownSources=[]);n.GetDropdownSource=function(t){var i=Enumerable.From(n.DropdownSources).Where(n=>n.Name==t).ToArray();return i.length>0?i[0].Data:[]};n.$watch("tblOptions.FilterVisible",function(){if(n.tblOptions!=undefined&&n.tblOptions.FilterVisible==!0&&n.DropdownSources.length==0){var i=Enumerable.From(n.tblOptions.Filters).Where(t=>n.IsNull(t.ControlType,"").toLowerCase()=="select").ToArray();angular.forEach(i,function(t){var i={Name:t.Name,Source:n.Request(t.Options.method,t.Options.parameter,t.Options.controller),Data:[]};n.DropdownSources.push(i)});n.DropdownSources.length>0&&t.all(Enumerable.From(n.DropdownSources).Select(n=>n.Source).ToArray()).then(function(t){angular.forEach(t,function(t,i){t.Type==2?n.SetSystemStatus(t.Message,"error"):n.DropdownSources[i].Data=t.Data.Rows})})}});n.ClearFilter=function(){function t(n){n.Options!=undefined?(n.Options.tblOptions!=undefined&&(n.Options.tblOptions.Filters!=undefined&&Enumerable.From(n.Options.tblOptions.Filters).ForEach(function(n){n.ControlType!=undefined?n.Type==12?n.Value=[null,null]:t(n):n.Value=null}),n.Value=null),n.Value=null):n.Value=null}Enumerable.From(n.tblOptions.Filters).ForEach(function(n){n.ControlType!=undefined?n.Type==12?n.Value=[null,null]:t(n):n.Value=null});n.RefreshLoadTable()}}}}]).directive("ngEnter",[function(){return function(n,t,i){t.bind("keydown keypress",function(t){t.which===13&&(n.$apply(function(){n.$eval(i.ngEnter)}),t.preventDefault())})}}]).directive("ngInput",["$compile","$controller","$timeout",function(n,t){return{require:"ngModel",restrict:"A",scope:{textType:"=",decimalPlace:"=?",dbDataType:"=?",textFormat:"=?",ngMin:"=?",ngMax:"=?",restrictInput:"=?"},link:function(i,r,u,f){if(i.ngModel=f,i.dbDataType!=undefined)$(r).input({type:i.dbDataType=="int"?"number":i.dbDataType=="decimal"?"decimal":""});else{if(i.restrictInput=="lettersonly")$(r).on("keydown",function(n){var t=n.which;t>=65&&t<=120||t==32||t==0||t==8||n.preventDefault()});if(i.textType!=undefined)if($(r).input({type:i.textType,format:i.textFormat}),i.textType=="date"){t("insysDatePickerController",{$scope:i,$element:r,$attrs:u});i.DisableTypeDate=function(n){var t=!1,r=!1,u=new Date(n.getFullYear(),n.getMonth(),[n.getDate()]),f,e;return i.ngMin!=undefined&&i.ngMin!=""&&i.ngMin!=null?(f=new Date(i.ngMin),t=u<f?!0:!1):t=!1,i.ngMax!=undefined&&i.ngMax!=""&&i.ngMax!=null?(e=new Date(i.ngMax),r=u>e?!0:!1):r=!1,t||r};r.on("blur",function(){if(/\S/.test(r.val())){if(r.val()==""||r.val()==null){f.$setViewValue(null);f.$render();i.$apply();return}var n=new Date(r.val());if(i.DisableTypeDate(n)){r.val(null);return}f.$setViewValue(moment(new Date(r.val())).format(i.textFormat||"MM/DD/YYYY"));f.$render();$("#insysDatePicker").length>0&&(i.updateCalendar(n.getMonth(),n.getDate(),n.getFullYear()),i.$apply())}});i.IsFirstLoad=!1;i.$watch(function(){return f.$modelValue},function(n){if(n!=""&&n!=undefined&&n!=null){f.$setViewValue(moment(new Date(n)).format(i.textFormat||"MM/DD/YYYY"));f.$render();var t=new Date(n);$("#insysDatePicker").length>0&&i.updateCalendar(t.getMonth(),t.getDate(),t.getFullYear());i.IsFirstLoad=!0}else f.$setViewValue(null),f.$render()})}else if(i.textType=="time"){t("insysTimePickerController",{$scope:i,$element:r,$attrs:u});r.on("focus",function(){var r,e,t;if((i.IsFirstLoad=!0,!u.readonly)&&!u.disabled){if(r=n('<div id="insysTimePicker"><select name="insysTimePicker-hours" ng-model="data.currentHour" id="insysTimePicker-hours" ng-change="jump()" ng-options="item disable when IsDisabledTime(item, data.currentMinute, data.currentFormat) for item in hours"><\/select><i>:<\/i><select name="insysTimePicker-minutes" ng-model="data.currentMinute" id="insysTimePicker-minutes" ng-change="jump()" ng-options="item disable when IsDisabledTime(data.currentHour, item, data.currentFormat) for item in minutes"><\/select><i>:<\/i><select name="insysTimePicker-format" ng-model="data.currentFormat" id="insysTimePicker-format" ng-change="jump()" ng-options="item disable when IsDisabledTime(data.currentHour, data.currentMinute, item) for item in formats"><\/select><\/div>')(i),e=$("body").find("#insysTimePicker"),e.length==0?$("body").append(r):e.remove(),$("body").append(r),f.$modelValue!=null){var o=f.$modelValue.split(":")[0],s=f.$modelValue.split(":")[1].split(" ")[0],h=f.$modelValue.split(" ")[1];i.updateClock(o,s,h)}else t=new Date,i.updateClock(t.getHours(),t.getMinutes(),t.getHours()>=12?"PM":"AM");i.$watch("data.selectedValue",function(){f.$setViewValue(i.data.selectedValue);f.$render()});i.$apply()}});r.on("blur",function(){var n;if(/\S/.test(r.val())){if(r.val()==""||r.val()==null){f.$setViewValue(null);f.$render();i.$apply();return}if(f.$setViewValue(moment(new Date((new Date).toDateString()+" "+r.val())).format(i.textFormat||"hh:mm A")),f.$render(),n=r.val(),$("#insysTimePicker").length>0){var t=n.split(":")[0],u=n.split(":")[1].split(" ")[0],e=n.split(" ")[1];i.updateClock(t,u,e);i.$apply()}}});i.IsFirstLoad=!1;i.$watch(function(){return f.$modelValue},function(n){var t;if(n!=""&&n!=undefined&&n!=null){if(i.IsFirstLoad)return;if(f.$setViewValue(moment(n).format(i.textFormat||"hh:mm A")),f.$render(),t=n,$("#insysTimePicker").length>0){var r=t.split(":")[0],u=t.split(":")[1].split(" ")[0],e=t.split(" ")[1];i.updateClock(r,u,e)}i.IsFirstLoad=!0}else f.$setViewValue(null),f.$render()})}else if(i.textType=="datetime"){r.on("blur",function(){if(r.val()==""||r.val()==null){f.$setViewValue(null);f.$render();i.$apply();return}/\S/.test(r.val())&&(f.$setViewValue(vcl.DateTime.Format(r.val(),vcl.DateTime.masks.inSysDateTime)),f.$render())});i.$watch(function(){return f.$modelValue},function(n){n&&n!=""&&(f.$setViewValue(vcl.DateTime.Format(n,vcl.DateTime.masks.inSysDateTime)),f.$render())})}}}}}]).directive("ngRadio",function(){return{restrict:"A",require:"ngModel",scope:{},link:function(n,t,i,r){t.on("click",function(){var n=i.value;n==1&&r.$viewValue!=1?r.$setViewValue(1):n==0&&r.$viewValue!=0?r.$setViewValue(0):n==1&&r.$viewValue==1?r.$setViewValue(null):n==0&&r.$viewValue==0&&r.$setViewValue(null);r.$render()})}}}).directive("insysUpload",["$controller",function(n){return{restrict:"E",scope:{readonly:"=",required:"=",options:"=",targetModel:"="},replace:!0,templateUrl:baseUrl+"Directives/insysUpload.tmpl.html",link:function(t,i,r){t.label=r.cLabel;n("BaseController",{$scope:t});t.elementName=r.name;t.fileName="";t.$watch("options",function(){t.options!=undefined&&(t.IsHidden=t.options.IsHidden)},!0);t.$watch("targetModel",function(){if(t.IsNull(t.targetModel,"")!=""){var n=t.targetModel.split(",");t.fileName=Enumerable.From(n).Select(n=>n.split(".CDITI.")[0]).ToArray().join()}});t.clear=function(){t.targetModel=null;t.fileName=""};t.upload=function(){t.UploadFile("UploadFile",t.options.Parameter,t.options.IsMultiple,t.options.Accept).then(function(n,i,r){n.Type==2?t.SetSystemStatus(n.Message,"error"):(t.targetModel=Enumerable.From(n.Data).Select(n=>n.FileName).ToArray().join(),t.fileName=Enumerable.From(n.Data).Select(n=>n.FileName.split(".CDITI.")[0]).ToArray().join(),t.$apply(),t.options.CallBack!=undefined&&t.options.CallBack(r))})};t.downloadFile=function(){var n=t.options.Parameter!=undefined?t.options.Parameter.folder!=undefined?t.options.Parameter.folder:"Files":"Files",i;t.options.DownloadFolder!=undefined&&t.options.DownloadFolder!=null&&t.options.DownloadFolder!=""&&(n=t.options.DownloadFolder);t.targetModel.split(",").length==1?t.Download(t.targetModel,n,t.targetModel.split(".CDITI.")[0]):(i={template:"DownloadContainer",controller:["$scope","dData","$uibModalInstance","$controller",function(t,i,r,u){u("BaseController",{$scope:t});t.files=[];t.Request("CheckFiles",{files:i.files,folder:i.folder},"Upload").then(function(n){n.Type==2?t.SetSystemStatus(n.Message,"error"):(t.files=n.Data,t.$apply())});t.close=function(){r.close(0)};t.getExtension=function(n){switch(n){case"doc":case"docx":return"fa-file-word";case"xls":case"xlsx":return"fa-file-excel";case"pdf":return"fa-file-pdf";case"txt":return"fa-file-alt";default:return"fa-file"}};t.getSize=function(n){var r=Math.round(n/1024),t,i,u;return r>0?(t=Math.round(r/1024),t>0?(i=Math.round(t/1024),i>0?(u=Math.round(i/1024),u>0?u+" TB":i+" GB"):t+" MB"):r+" KB"):n+" "+(n>1?"bytes":"byte")};t.downloadFile=function(i,r){t.Download(i,n,r)}}],size:"lg",windowClass:"download-files-dlg",data:{files:t.targetModel.split(","),folder:n}},t.Dialog(i))};t.disable=function(n){n.preventDefault()}}}}]).directive("lazyLoadImage",["DataService","$controller",function(n,t){return{restrict:"A",scope:{lazyLoadImage:"="},link:function(i,r){t("BaseController",{$scope:i});i.$watch("lazyLoadImage.Image",function(){r.css({"background-image":"url(data:image/png;base64,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)","background-repeat":"no-repeat","background-size":"contain"});i.lazyLoadImage.Image||r.addClass("no-img");n.Post("LoadImage",{ImgFile:i.lazyLoadImage.Image,Container:i.lazyLoadImage.Container||null,Path:i.lazyLoadImage.Path||null,Size:i.lazyLoadImage.Size||null},"Base",!0).then(function(n){if(n.Type==2)i.SetSystemStatus(n.Message,"error"),r.css({"background-image":"url(data:image/png;base64,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)","background-size":"initial"}),r.addClass("no-img");else var t=setTimeout(function(){if(clearTimeout(t),n){r.css({"background-image":"url("+n.Data+")","background-size":"contain"});var i=setTimeout(function(){clearTimeout(i)},1e3)}else r.css({"background-image":"url(data:image/png;base64,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)","background-size":"contain"}),r.addClass("no-img");(n.Data==null||n.Data=="")&&(r.css({"background-image":"url(data:image/png;base64,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)","background-size":"contain"}),r.addClass("no-img"))});i.$apply()}).fail(function(){r.css({"background-image":"url(data:image/png;base64,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)","background-size":"initial"});r.addClass("no-img")})})}}}]).directive("insysReport",["$controller","$http","$rootScope","$sce",function(n,t,i,r){return{restrict:"E",scope:{options:"="},replace:!0,templateUrl:baseUrl+"Directives/insysReport.html",link:function(u,f){n("insysReportController",{$scope:u});var e={Pdf:{Method:"",Parameter:{},Controller:""},Xls:{Method:"",Parameter:{},Controller:""},hasLoadPdf:!0,hasExportXls:!0,triggerLoadPdf:function(){},triggerLoadXls:function(){},reportReady:!1};u.options=$.extend(e,u.options);u.webReportUrl=r.trustAsResourceUrl(localStorage.getItem("HtmlTemplatePath").substr(1)+"Web/PDFViewer/web/viewer.html");f.ready(function(){var n=f.find("iframe")[0],r=n.contentWindow?n.contentWindow:n.contentDocument.defaultView;u.RefreshReport=function(){u.options.Pdf.Method==""||u.options.Pdf.Controller==""?u.SetSystemStatus("Method or Controller not defined."):u.LoadReport(u.options.Pdf.Method,u.options.Pdf.Parameter,u.options.Pdf.Controller).then(function(n){if(n.Type==2)u.SetSystemStatus(n.Message,"error");else if(u.SetSystemStatus("Loading report","loading"),n.Data.UseReportServer==!0)t.post(n.Data.Url,{ID:n.Data.ID,sID:i.SessionID}).then(function(n){if(n.data.Type==2)u.SetSystemStatus(n.data.Message,"error");else{var t=u.convertDataURIToBinary(n.data.Data);r.PDFViewerApplication.open(n.data.Data);u.SetSystemStatus("Ready")}});else{var f=u.convertDataURIToBinary(n.Data);r.PDFViewerApplication.open(n.Data);u.SetSystemStatus("Ready")}})};u.DownloadExcel=function(){u.options.Xls.Method==""||u.options.Xls.Controller==""?u.SetSystemStatus("Method or Controller not defined."):u.LoadReport(u.options.Xls.Method,u.options.Xls.Parameter,u.options.Xls.Controller).then(function(n){n.Type==2?u.SetSystemStatus(n.Message,"error"):(u.SetSystemStatus("Loading report","loading"),n.Data.UseReportServer==!0?t.post(n.Data.Url,{ID:n.Data.ID,sID:i.SessionID}).then(function(n){n.data.Type==2?u.SetSystemStatus(n.data.Message,"error"):(window.open(n.data.Data),u.SetSystemStatus("Ready"))}):(window.open(n.Data),u.SetSystemStatus("Ready")))})};u.options.triggerLoadPdf=u.RefreshReport;u.options.triggerLoadXls=u.DownloadExcel;u.$apply();u.options.reportReady=!0})}}}]).directive("insysOrgChart",["$compile",function(n){return{restrict:"A",scope:{insysOrgChart:"=",displayColumn:"=",getSelected:"&",allowCheck:"=?"},transclude:!0,replace:!0,templateUrl:baseUrl+"Directives/insysOrgChart.tmpl.html",compile:function(t,i,r){var f=t.contents().remove(),u;return function(t,i){t.allowCheck=t.allowCheck==undefined?!0:t.allowCheck;u||(u=n(f,r));u(t,function(n){i.append(n)});t.ToggleChildren=function(n){n.ShowChild=!n.ShowChild};t.$watch("insysOrgChart",function(){Enumerable.From(t.insysOrgChart).ForEach(function(n){n.Children==undefined&&(n.Children=[])})});t.getNodeState=function(n){return n.ShowChild==!1||n.ShowChild==undefined?"fa-chevron-down":"fa-chevron-up"};t.selectNode=function(n){n.Children.length==0&&(t.getSelected({data:n}),$(".tree-li").removeClass("tree-selected"),$("#tree-"+n.ID_Menus).addClass("tree-selected"))}}}}}]).directive("insysTable",["$controller",function(n){return{templateUrl:baseUrl+"Directives/insysTable.tmpl.html",scope:{options:"=",getLoad:"=",updateOptions:"="},restrict:"E",link:function(t){n("insysTableController",{$scope:t});t.initTable=function(){return t.LoadTable(t.options.tblOptions,t.options.Method,t.options.Controller,t.options.Parameter).then(function(n){return n.Type==2?t.SetSystemStatus(n.Message,"error"):t.SetSystemStatus("Ready"),t.$apply(),t.tblOptions})};t.$watch("options.tblOptions",function(n,i){JSON.stringify(n)!=JSON.stringify(i)&&(t.tblOptions=$.extend(t.options.tblOptions,t.tblOptions))},!0);t.getLoad=t.initTable;t.delete=function(){console.log(t.options.tblOptions);t.options.tblOptions.deleteRow(t.tblOptions)}}}}]).directive("insysMenuTree",["$compile",function(n){return{restrict:"A",scope:{insysMenuTree:"=",displayColumn:"=",getSelected:"&",allowCheck:"=?"},transclude:!0,replace:!0,templateUrl:baseUrl+"Directives/insysMenuTree.tmpl.html",compile:function(t,i,r){var f=t.contents().remove(),u;return function(t,i){t.allowCheck=t.allowCheck==undefined?!0:t.allowCheck;u||(u=n(f,r));u(t,function(n){i.append(n)});t.ToggleChildren=function(n){n.ShowChild=!n.ShowChild};t.$watch("insysTree",function(){Enumerable.From(t.insysTree).ForEach(function(n){n.Children==undefined&&(n.Children=[])})});t.getNodeState=function(n){return n.ShowChild==!1||n.ShowChild==undefined?"fa-plus-square":"fa-minus-square"};t.selectNode=function(n){(n.Children.length==0||n.ID_MenusType==2||n.ID_MenusType==3)&&(t.getSelected({data:n}),$(".tree-li").removeClass("tree-selected"),$("#tree-"+n.ID_Menus).addClass("tree-selected"))}}}}}]).directive("orgMenu",["$controller",function(n){return{templateUrl:baseUrl+"Directives/orgMenu.tmpl.html",restrict:"E",replace:!0,transclude:!0,scope:{treeData:"=",request:"&",parentData:"=",deleteOrg:"="},link:function(t){n("BaseController",{$scope:t});t.$watch("treeData",function(n){t.tree=n});t.IsCompany=!1;t.addRecord=function(n){n.ID_Parent===undefined&&(t.IsCompany=!0);t.Request("LoadCompanyNewDefaultOrg",{Data:n,IsCompany:t.IsCompany,MenuCode:"PeopleOrganizationCompany"},"Company").then(function(n){if(n.Type==2)t.SetSystemStatus(n.Message,"error");else return t.Dialog({template:"CompanyOrg",controller:"CompanyOrgCtrl",size:"sm",windowClass:"company-org-dlg",data:{Schema:n.Data.Schema}})})};t.Check=function(n){setTimeout(function(){n.IsChecked?t.deleteOrg.push(n.ID):t.deleteOrg.splice(t.deleteOrg.indexOf(n.ID),1);t.$apply()},50)};t.openChild=function(n){t.Request("GetLastHeirarchyLevel",{ID_Company:n.ID_Company,MenuCode:"PeopleOrganizationCompany"},"Company").then(function(i){i.Type==2?t.SetSystemStatus(i.Message,"error"):(i.Data.ID!=n.ID_CompanyOrgType&&(n.IsOpen=!n.IsOpen,n.Children.length==0&&t.Request("GetChildOrg",{ID:n.ID,MenuCode:"PeopleOrganizationCompany"},"Company").then(function(i){i.Type==2?t.SetSystemStatus(i.Message,"error"):(n.Children=i.Data.CompanyChildren,t.SetSystemStatus("Ready"))})),t.SetSystemStatus("Ready"))})}}}}]).controller("CompanyOrgCtrl",["$scope","dData","$controller","$state","$uibModalInstance",function(n,t,i,r,u){i("BaseController",{$scope:n});n.Org=t.Schema;n.$watch("Org",function(t){n.Org=t});n.MasterLookup={tblOptions:{Columns:[{Name:"ID",Label:"#"},{Name:"Name",Label:"Name"}]},method:"LoadLookUp",controller:"Company",parameter:{OrgType:n.Org.ID_OrgType,Name:"Master",MenuCode:"PeopleOrganizationCompany"}};n.Close=function(){u.dismiss()};n.Submit=function(){n.Request("SaveHeirarchy",{Data:n.Org||{},MenuCode:"PeopleOrganizationCompany"},"Company").then(function(t){t.Type==2?n.SetSystemStatus(t.Message,"error"):(n.Prompt("Save successfull.","Success"),r.go(r.current.name,{},{reload:!0}))})}}]).directive("inputSearch",["$timeout",function(){return{restrict:"E",scope:{sourceList:"=",tmpList:"="},templateUrl:baseUrl+"Directives/inputSearch.tmpl.html",link:function(n,t){t.on("keyup",function(t){var i=$(t.target).val(),r=i.trim().toLowerCase().split(" ");i==""?(n.tmpList=n.sourceList,n.$apply()):i.length>2&&(n.tmpList=Enumerable.From(n.sourceList).Where(function(n){for(var t in r)return n.Name.toLowerCase().trim().indexOf(r[t])>-1}).ToArray(),n.$apply())});n.preventEnterKey=function(n){n.keyCode==13&&n.preventDefault()}}}}]);